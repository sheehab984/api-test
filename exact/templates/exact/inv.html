{% load mathfilters %}
<html>
<head>
	<title>Voorraad Lichtplanners / Jibe </title>

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<style>
table {
  border-collapse: collapse;
  width: 100%;
}

th, td {
  text-align: left;
  padding: 8px;
}

tr:nth-child(even){background-color: #f2f2f2}

th {
  background-color: #4CAF50;
  color: white;
}
</style>

<body>
	<div class="container">
	  <h2>Filterable Table</h2>
	  <p>Type something in the input field to search the table for first names, last names or emails:</p>
	  <input class="form-control" id="myInput" type="text" placeholder="Search..">
	  <br>
	  <table class="table table-bordered table-striped">
	    <thead>
			<tr>
				<th>ItemCode</th>
				<th>ItemDescription</th>
				<th>Voorraad Lichtplanners</th>
				<th>Vooraad Jibe</th>
				<th>Vooraad Totaal</th>
				<th>ItemGroupCode</th>
				<th>Foto</th>
			</tr>

			<tbody id="myTable">
				{% for item in data1 %}
					<tr>
                        {% for item2 in data2 %}
                            {% if item.ItemCode == item2.Code %}
																<td>{{ item.ItemCode }}</td>
																<td>{{ item.ItemDescription }}</td>
																{% if item.CurrentStock == 0 %}
																<td> - </td>
																{% else %}
																<td>{{ item.CurrentStock }}</td>
																{% endif %}
																{% if item2.Stock|sub:item.CurrentStock == "" %}
																<td> - </td>
																{% elif item2.Stock|sub:item.CurrentStock == 0 %}
																<td> - </td>
																{% else %}
																<td>{{ item2.Stock|sub:item.CurrentStock}}</td>
																{% endif %}
																{% if item2.Stock == None %}
																<td> - </td>
																{% else %}
																<td>{{ item2.Stock }}</td>
																{% endif %}
                                <td>{{ item2.ItemGroupCode }}</td>
																<td><img src="{{ item2.PictureThumbnailUrl }}" alt="" border=3 height=100 width=100></img></td>
                            {% endif %}
                        {% endfor %}

					</tr>
				{% endfor %}
			</tbody>
		</thead>
	</table>
	</div>
    {% for i in data %}
        {{ i }}<br><br>
    {% endfor %}
</body>
<script>
$(document).ready(function(){
  $("#myInput").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#myTable tr").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});
</script>
<script>
var seen = {};
$('table tr').each(function() {
    var txt = $(this).children("td:eq(0)").text();
    console.log(txt)
    if (seen[txt])
        $(this).remove();
    else
        seen[txt] = true;
});
</script>
</html>
